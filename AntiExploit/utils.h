#pragma once
#include "framework.h"
#include <strsafe.h>
//#include <ntstatus.h>
//#include <winternl.h>
#include <tlhelp32.h>
#include <memory>
#include <string>
#include <stdexcept>

ULONG CheckASLR(ULONG dwProcessId, ULONG& bASLR);
ULONG CheckDEP(ULONG dwProcessId, ULONG& depStatus);
BOOL CheckSafeSEHStackCanary(ULONG dwProcessId, ULONG& safeSEHMissing, ULONG& safeSEHUnknown, ULONG& stackCookieMissing, ULONG& stackCookieUnknown, ULONG& nModules);
BOOL CheckLoadConfig(HANDLE hModule, BYTE* header, DWORD base, BOOLEAN& safeSEH, BOOLEAN& stackCanary);

template<typename ... Args>
std::string string_format(const std::string& format, Args ... args);

HBITMAP IconToBitmap(HICON Icon_Handle);

HMODULE sm_LoadNTDLLFunctions();
